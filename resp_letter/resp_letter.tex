\documentclass[a4paper,12pt]{article}
\usepackage{latexsym}
\usepackage{array}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{bm}
\usepackage{color}
\usepackage{colortbl}
\usepackage{cite}
\usepackage{float}
\usepackage{graphicx}
\usepackage{ulem}
\usepackage{booktabs}
\usepackage[Symbol]{upgreek}
\usepackage{subfigure}
\usepackage{stfloats}
\usepackage{threeparttable}
\usepackage{theorem}
\usepackage{times}
\usepackage{dcolumn}
\usepackage{multirow}
\usepackage[boxed]{algorithm2e}
\usepackage{framed}

\newtheorem{theorem}{\bf Theorem}
\newtheorem{proposition}{\bf Proposition}
\newtheorem{lemma}{\bf Lemma}
\newtheorem{definition}{Definition}
\newtheorem{remark}{\bf Remark}


\setlength{\textheight}{245mm}
\setlength{\textwidth}{170mm}
\setlength{\topmargin}{-15mm}
\setlength{\oddsidemargin}{-5mm}
\setlength{\evensidemargin}{-5mm}
\flushbottom
\setlength{\parindent}{0pt}
\setlength{\baselineskip}{17pt}
\setlength{\parskip}{3mm}
\setlength{\columnsep}{8mm}
\renewcommand{\baselinestretch}{1.3}
\hyphenation{op-tical net-works semi-conduc-tor IEEEtran}
\DeclareGraphicsRule{.png}{eps}{.bb}{}
\allowdisplaybreaks[4]

\newcommand{\PreserveBackslash}[1]{\let\temp=\\#1\let\\=\temp}
\newcommand{\red}[1]{{\color{red}{#1}}}
\newcommand{\blue}[1]{{\color{blue}{#1}}}
\newcommand{\black}[1]{{\color{black}{#1}}}
\newcommand{\Authors}[1]{{\blue{{\textbf{Authors: }}{#1}}}}


\newenvironment{IEEEproof}{{\it Proof. }}{}
\newcolumntype{C}[1]{>{\PreserveBackslash\centering}p{#1}}
\newcolumntype{R}[1]{>{\PreserveBackslash\raggedleft}p{#1}}
\newcolumntype{L}[1]{>{\PreserveBackslash\raggedright}p{#1}}

\def \T {^{\mathsf{T}}}
\def \H {^{\mathsf{H}}}
\def \ri {{\rm i}}
\def \d {{\rm d}}
\def \tr {{\mathsf{tr}}\,}

\def\onecol{}

\begin{document}

\begin{center}
 {\Large\bf Electromagnetic Information Theory: Fundamentals, Modeling, Applications, and Open Problems}
\end{center}
\begin{center}
 {\Large\bf (Original paper ID: WCM-22-00602)}
\end{center}
\begin{center}
 {\Large\bf Response Letter}
\end{center}
\begin{center}
Jieao Zhu, {\it Student Member,~IEEE}, Zhongzhichao Wan, {\it Student Member,~IEEE}, \\Linglong Dai, {\it Fellow,~IEEE},  M\'{e}rouane Debbah, {\it Fellow,~IEEE}, \\and H. Vincent Poor, {\it Life Fellow,~IEEE} 

\end{center}
\begin{center}
 {\Large\bf Response to Editor's Comments}
\end{center}


\textbf{Editor}: The review of the above manuscript submitted to IEEE Wireless Communications has been completed. The reviewers have recommended that major revisions be made to the manuscript. An acceptance decision will not be made until these revisions have been made and a second review has been completed. Please include detailed responses to the reviewers' comments. 

\blue{
    {\bf Authors:}
    We would like to commence by thanking the editor and three professional reviewers for their valuable time in evaluating our submission. Your constructive comments and expert knowledge of the field have helped us to strengthen the manuscript significantly. We endeavored to address all the suggestions and comments, and our reflections are provided below in a point-to-point manner. We also indicate how our manuscript has been revised accordingly, and all the revisions have been highlighted in \red{red} color in the revised paper. Here, we would like to make a brief summary of the major revisions in the revised paper as below:
    \begin{enumerate}
        \item We have added achievability proofs for the proposed vM-EM phase estimation algorithm. 
        \item We have clarified the extensibility of the proposed scheme to broader scenarios including RIS-aided MIMO systems. 
        \item We have changed the baselines to MMSE algorithms, improved the simulations, and presented the performance comparisons in a more reasonable manner. 
    \end{enumerate}
}

\blue{
    {\bf Authors}:
    Many thanks again for Editor's and all the Reviewer's valuable time and efforts to review this paper. Based on your constructive comments, we have already made a careful major revision of this paper, which is attached to the end of this letter. 
    \\
    \\
    Sincerely, 

    {\it The Authors}
}

\clearpage


\begin{center}
    {\Large\bf Response to Reviewer 1's Comments}
\end{center}

{\textbf{Reviewer 1:}}
This paper provides a timely review on electromagnetic information theory. The major concerns are:

(1) While a review paper may not contain too much detail or math, this work has absolutely no math formula, making the statement not clear at all (especially to readers new to this topic). I find the conclusions made in this work not supported and even confusing. In particular, the following point is not clear.

{\color{blue}{\textbf{Authors: } 
We appreciate the reviewer's concise summary of the key points of this paper and the positive evaluations on our work. We have tried our best to revise the paper according to the reviewer's valuable comments, and our responses are provided in a point-to-point manner as follows. 
}}

\textbf{Reviewer 1:}
(2) In the open problem section VI.D, it says that the achievability of capacity is not proved. Then typically in information theory, this means that the capacity is not found at all. Capacity has an operational meaning, which is the highest rate. It may or may not be the maximum mutual information, depending on the channel assumption (which appears core for this new area of electromagnetic IT). So it appears to me that [9] [11] at most provide an upper bound (converse) for the capacity and the capacity is an open problem. Additionally, the claims on the hardness of achievability or converse proofs are purely subjective. When a problem is open, everything could be hard. When the answer is known, it is not easy to reach a consensus on which part is harder (in IT, it could be more widely believed that converse is harder).

\blue{\textbf{Authors: } 
Many thanks for pointing out these limitations in {\bf Section VI-D} of this paper. As mentioned by the reviewer, the ``capacity'' has an operational meaning, and the maximum mutual information does not necessarily equal the ``capacity''. Thus, the EM capacity has not been found in the strict sense. We agree with the reviewer that the existing works about the EM capacity is still in their infancy. However, substantial progresses have been made in the literature about the EM capacity. As a result, we will summarize the current progress of the electromagnetic capacity problem in the following two parts.  

(2.1) {\bf Achievable Rates.} By assuming a linear time-invariant propagation environment, the EM channel is modeled by a spatio-temporal (4-dimensional) linear Green's function. This Green's function is viewed as a linear operator that maps the current distribution on the transmitter (source) to the receiver (destination). Since any (bounded) linear operator possesses a singular value decomposition, the Green's function is then decomposed into a series of eigenmodes [R1-2] before performing water-filling on the decomposed parallel sub-channels. 
By further assuming an additive white Gaussian noise, the achievable rates are obtained by summing the maximum mutual information over the (possibly infinite) Gaussian sub-channel index. This summation of mutual information is achievable, since the maximum mutual information of each of the sub-channels can be achieved by the random ensemble of Gaussian distributed codes. 
However, these achievable rates are neither theoretically inspiring nor easy-to-compute.  


(2.2) {\bf Converse Bounds.} As is mentioned by the reviewer, converse bounds can be obtained by evaluating the maximum ``continuous'' mutual information between the source and destination regions. In order to ensure the theoretical soundness of such an EIT upper bound, this bound (measured in bit/s or bit/s/Hz) should be independent of the choice of transceiver antennas, the shape of the transceiver antenna arrays, the adopted precoding/combining methods, and the employed channel codes. Fortunately, if we focus our attention only on the electric currents ${\bm J}({\bm s})$ generated by the transmitter in the source region  as well as the electric fields ${\bm E}({\bm r})$ induced in the destination region, a natural definition of this EIT bound is the mutual information $I({\bm J}({\bm s}); {\bm E}({\bm r}))$ between the current field and the electric field. Thus, theoretically this mutual information involves the definition of the amount of information of a random function contained in another such function. The definition of such type of mutual information dates back to 1959 in the mathematical paper [R2], and has been transplanted to the EIT problem in the recent paper [R3]. 



\quad In the revised paper, we have rewritten this subsection as 

% References. 
\blue{
[R1] M. A. Jensen, and J. W. Wallace, ``Capacity of the continuous-space electromagnetic channel,'' {\it IEEE Trans. Antenna Propag.}, vol. 56, no. 2, pp. 524-531, Feb. 2008. 

[R2] I. M. Gelfand and A. IAglom, ``Calculation of the amount of information about a random function contained in another such function,'' {\it American Mathematical Society Providence}, 1959. 

[R3] Z. Wan, J. Zhu, Z. Zhamg, L. Dai, and C.-B. Chae, ``Mutual information for electromagnetic information theory based on random fields,'' {\it ArXiv preprint arXiv:2111.00496}, Aug. 2022. 

[R4] F. K. Gruber, and E. A. Marengo, ``New aspects of electromagnetic information theory for wireless and antenna systems,'' {\it IEEE Trans. Antenna Propag.}, vol. 56, no. 11, pp. 3470-3484, Nov. 2008. 

}


}

\begin{framed}
    {\bf Section VI-D} \\
    \red{In classical information theory, the ``capacity'' is defined as the supremum of all the operationally achievable transmission rates. It is favorable that in discrete memoryless systems, the capacity equals the maximum mutual information, but this conclusion is generally not true for all kinds of channels. In the existing works on EIT~[8, 9, 11], maximum mutual information values are calculated under the assumptions of monochromatic waves, linear deterministic EM channels and continuous transceivers. Unfortunately, these mutual information values only serve as an upper bound to the EM capacity. 
    Thus, in the strict sense, the EM capacity is still an open problem. } 
\end{framed}



%---------------------------------------------------------------------

\textbf{Reviewer 1:}
(3) The meaning of many pictures is not clear. For example, why Fig.~5 shows a new possibility for capacity improvement? The light blue part means a wider coverage? Why and how to use?

{\color{blue}{\textbf{Authors: } 
Thanks for the reviewer's suggestions. 


\quad All the above contents are added to the revised paper. 

}}





{\color{blue}{\textbf{Authors: } 
Many thanks again for your valuable time and efforts to review this paper. 
\\
\\
Sincerely, 
\\
{\it The Authors }
}}

\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{center}
    {\Large\bf Response to Reviewer 2's Comments}
\end{center}

\textbf{Reviewer 2:}
In this paper, the authors briefly discussed the concept of Electromagnetic Information Theory (EIT). Specifically, in the first section, they introduced the main topic, i.e, EIT. Next, in Section 2, they explained the fundamentals of EIT, including (1) degree of freedom, (2) channel capacity, (3) Electromagnetic (EM) theory, and (4) random fields for EIT. In Section 3, the authors introduced modeling methodologies for EIT, including (1) continuous channel modeling, and (2) noise field modeling. In Section 4, they further discussed EIT analysis methods, such as (1) functional DoF, (2) channel DoF, and (3) mutual information and capacity analysis. Finally, the authors discussed some applications of EIT in Section 5 and open problems in Section 6, before concluding the paper in Section 7.

{\color{blue}{\textbf{Authors: } 
We appreciate the reviewer's concise summary of the key points of this paper. We have tried our best to revise the paper according to the reviewer's valuable comments, and our responses are provided in a point-to-point manner as below. 
}}


\textbf{Reviewer 2:}
Overall, the topic is fundamental and important to wireless communications. Nevertheless, the quality of the paper must be substantially improved. The major concerns are listed below.

1) In the introduction, the explanation of the potential deficiencies of existing information-theoretical models is very unclear. For example, what are the key issues of the discretization of transmitters/receivers, which is very common when modeling wireless channels? Does the discretization violate any physical laws? Does it overestimate or underestimate the information theoretical capacity of a wireless channel?


\blue{\textbf{Authors: } 
Many thanks for the reviewer's overall positive attitude on this magazine paper, and we are thankful to the reviewer for pointing out the limitations in the introduction part. We will commence by explaining why direct discretization, which is the foundation of the MIMO model, will inevitably lead to problematic results in evaluating the information-theoretic capacity of an electromagnetic (EM) communication system, especially when considering a superdense antenna array.

\quad The widely accepted MIMO channel model takes the form ${\bm y}={\bm H}{\bm x}+{\bm n}$, where ${\bm x}\in\mathbb{C}^{M}$ is the signals transmitted by the $M$-antenna transmitter, and ${\bm y}\in\mathbb{C}^{N}$ is the signals received by the $N$-antenna receiver. The MIMO channel is represented by ${\bm H}\in\mathbb{C}^{N\times M}$, and the noise vector ${\bm n}\sim \mathcal{CN}({\bm 0}_{N}, \sigma^2 {\bm I}_{N})$. The information-theoretic capacity is then expressed as 
\begin{equation}
    C = \log\det({\bm I}+\frac{1}{\sigma^2}{\bm H}{\bm C}_{\bm x}{\bm H}\H),
\end{equation}
where ${\bm C}_{\bm x}=\mathbb{E}\left[{\bm x}{\bm x}\H\right]$ is the covariance matrix of the transmitted signal ${\bm x}$, satisfying the transmit power constraint $\tr{\bm C}_{\bm x}\leq P_T$. The correctness of this classical MIMO model heavily relies on the following two discretization assumptions:
\begin{enumerate}
    \item The discrete\footnote{Here ``discrete'' means the noise values are random variables that are indexed by a discrete antenna index $n$} noise, i.e., the components of the noise vector ${\bm n}$, are uncorrelated for any pair of receive antennas. 
    \item The average discrete noise power $\sigma^2$ is a constant, which is independent of the number of transceiver antennas and the antenna spacing. 
\end{enumerate}
Note that the assumption (2) ensures an unchanged receive SNR $\gamma_{\rm R}=\mathbb{E}[{\bm y}\H{\bm y}]/(N\sigma^2)$ as the number of receive antennas $N\to\infty$ (but the receiving antennas are confined in a finite receive volume $V_{\rm R}$ [R]). However, it can be numerically verified that as $N\to\infty$, the MIMO capacity $C$ will diverge to infinity, even if the channel model is given by the line-of-sight (LoS) Green's function model
\begin{equation}
    [{\bm H}_{mn}] = \frac{1}{4\pi r_{mn}}e^{-\ri 2\pi r_{mn}/\lambda}\quad [{\rm bit/s/Hz}],
\end{equation}
where $r_{mn}=|{\bm r}_m-{\bm r}_n'|$ is the geometric distance from the $m$-th transmit antenna to the $n$-th receive antenna, and $\lambda$ is the operating wavelength. This divergence of the system capacity contradicts the common belief that only a finite number of bits can be transmitted per unit time and unit bandwidth by the EM channel that connects a pair of given transmitter and receiver with confined volumes $V_{\rm T}$ and $V_{\rm R}$. 

\quad This contradiction is because real-world EM systems do not follow the two discretization assumptions as are previously listed. (1) In real-world EM systems, the EM noise can be highly correlated, given that the antenna spacing becomes smaller. This is because the EM couping effect becomes more dominant when the antennas are placed closer to each other. A direct effect of this coupling on the mathematical model of the noise vector $\bm n$ is that the uncorrelated assumption is no longer valid, i.e., the noise exhibits a stronger spatial correlation. Mathematically, if this spatial correlation becomes stronger, the EM channel capacity will become lower. This is because a more correlated noise has a near-singular covariance matrix ${\bm C}_{\bm n}$, which decreases the MIMO capacity $C=\log\det(I+{\bm C}_{\bm y}{\bm C}_{\bm n}^{-1})$. In this way, recent results in [R1] have established a finite-valued capacity for this kind of EM channels. (2) The noise power modeling problem is subordinate to the noise correlation modeling problem in (1), since the diagonal entries of a correlation matrix automatically gives the power of each random variable. 

\quad In summary, if we apply discretization to the EM systems in reality and try to reach a linear MIMO model, special attentions should be paid to the modeling of the noise vector ${\bm n}$. The discretization itself is correct, since any continuous function can be weakly approximated by its discrete counterpart (expressed by linear combinations of the $\delta$-functions) in functional analysis [R2], and this discretization does not violate any mathematical or physical principles. However, the discretized noise can exhibit a serious deviation from the uncorrelated standard Gaussian model, especially when the antenna spacing is much smaller than $\lambda/2$. In the study of EIT, it is a constant attempt to reveal how the capacity behaves when the antenna spacing decreases. As a consequence, the normal discretization techniques and formulas should be re-considered. 

{\bf References}

[R1] J. Zhu, Z. Zhang, Z. Wan, and L. Dai, ``On finite-time mutual information,'' in {\it Proc. 2022 IEEE Int. Symp. Inf. Theory (IEEE ISIT'22)}, Espoo, Finland, Jun. 2022. 

[R2] J. Muscat, {\it Functional analysis: An introduction to metric spaces, Hilbert spaces, and Banach algebras,} Springer, 2014. 

}

%%%%%%%%%%%%%%%%%%%%

\textbf{Reviewer 2:}
2) All the figures are confusing to readers.
2.1) There are many notations in Figs. 1, 2, 3, 4. However, they have not been clearly defined. 

{\color{blue}{\textbf{Authors: } 
Many thanks again for your valuable time and efforts to review this paper. 
\\
\\
Sincerely, \\
{\it The Authors }
}}

\clearpage 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{center}
    {\Large\bf Response to Reviewer 3's Comments}
\end{center}

\textbf{Reviewer 3:}
This paper introduces a dimension-independent CSI acquisition method for sensing
RIS-assisted MISO wireless communication systems. The key issue of the paper is that the achievable schemes look like heuristic with no performance guarantees, and the methodology does not seem novel.

{\color{blue}{\textbf{Authors: } 
We appreciate the reviewer's concise summary of the key points of this paper. We have tried our best to address these issues in the revised paper according to the reviewer's valuable comments. Specifically, we have added achievable theorems for our proposed vM-EM phase estimation algorithm, and our responses are provided in a point-to-point manner as below. 
}}

\textbf{Reviewer 3:}
1) The paper considers a MISO system. Can the approaches work for MIMO system?

{\color{blue}{\textbf{Authors: } 
Thanks for the insightful comments of the reviewer. Since the definition of MIMO systems usually include two possible explanations: the multi-antenna MIMO and the multi-user MIMO, we will elaborate on both of these two explanations. 

1.1) Actually, the extensibility to multi-antenna MIMO case is possible without sacrificing the number of time slots for CSI acquisition. By placing the pilot symbols on different OFDM subcarriers across different antennas, all the antennas at the user can transmit rotational pilots simultaneously at different frequencies. Then, the power sensors attached to each RIS element can split the signal of the interference random field (IRF) into components of different frequencies, and perform phase estimation separately for different antennas. Mathematically, it is possible to retrieve $K$ different phases $\varphi_k\in[0,2\pi], k\in\{1,2,\cdots,K\}$ from the following composite power signal 
\begin{equation}
    P(t) = \left|\alpha + \sum_{k=1}^{K} \beta_k e^{\ri \omega_k t}  e^{\ri \varphi_k}\right|^2,
\end{equation}
where $\beta_k>0$, and $\omega_k\neq\omega_\ell$ for different antenna indices $k,\ell$. In fact, by assuming a sufficiently small interferential power ratio $r=(\alpha)^{-2}\sum_k \beta_k^2$, the power signal $P(t)$ can be locally linearized into one DC component $\alpha^2$ and $K$ AC components $2\alpha\beta_k \cos(\omega_k t+\varphi_k)$ of different frequencies $\omega_k$, which may further be decomposed by applying the Fourier transform. Clearly, this sensing RIS-aided multi-antenna MIMO CSI acquisition method is sub-optimal. However, designing the optimal method to estimate all the $\varphi_k$ and $\beta_k$ accurately is also interesting, and we will leave it for our future work. 

1.2) The extensibility to multi-user MIMO case. Similar to the above multi-antenna MIMO case, the simultaneous CSI acquisition methodology also works for the multi-user case. By transmitting pilot symbols that rotate at different frequencies, the RIS power sensor can still distinguish between different users. 
Moreover, since usually different users are separated in the angular domain from the RIS's perspective [R1], in the multi-user case, the RIS can further exploit such angular separation property to distinguish between different users. Thus, by exploiting multi-sensor joint detection and estimation at the RIS, the CSI acquisition precision may be further improved due to the additional angular orthogonality among users. Such an extension to the multi-user MIMO case is also left for our future work, and we have added a brief discussion about this idea in the revised version.  

% It is worth pointing out that the method we proposed to estimate the channel phase difference $\varphi$ is heuristic, which may not be the optimal one. It has been verified in the paper that our method is simple and efficient. However, designing the optimal method to estimate ${{\varphi_{l,c}}}$ is also interesting, and we will leave it for our future work. In the revised paper, we have addressed this issue as:

\quad Specifically, in the revised paper, we have addressed these issues as:
}}

\begin{framed}
{\bf Section IV-B}

    \red{In fact, for multi-antenna MIMO systems, rotating pilot symbols at different frequencies $k$ can be simultaneously transmitted by different antennas to enable CSI acquisition.  
    Then, the multi-antenna CSI acquisition can be fulfilled by performing Fourier analysis on the composite IRF power signal $P(t)$, and extracting the phase angles for each antenna at distinct frequencies. 
    Similarly, this pseudo-frequency division idea can be extended to multi-user MIMO systems, where different users can also be distinguished by different IRF frequencies. Fortunately, since different users are usually separated in the angular domain from the RIS's perspective, these users can be further identified by performing joint detection and estimation across all the RIS sensors. The joint multi-user CSI acquisition is beyond the scope of this paper, and is left for our future work. }
\end{framed}

\blue{
    {\bf References:}

[R1] C. Pan et al., ``An Overview of Signal Processing Techniques for RIS/IRS-Aided Wireless Systems,'' {\it IEEE J. Sel. Topics Signal Process.}, vol. 16, no. 5, pp. 883-917, Aug. 2022. 
}



\textbf{Reviewer 3:}
2) The new contribution from algorithm seems to be phase estimation in Section V. However, all the approaches seem direct and heuristic. There are no performance guarantees of the proposed approaches.

{\color{blue}{\textbf{Authors: } 
Many thanks for the reviewer's high expectation on this paper. To respond to the reviewer's questions, we would like to clarify our contributions and explain the meanings of the proposed algorithms in a more systematic manner. 
Specifically, we will show the underlying logic in the proposed algorithms to justify their rationale. 
Also, as is stressed by the reviewer, it is important to provide performance guarantees for the proposed approaches. We have tried our best to conceive achievability theorems for our proposed algorithms. These theorems and the corresponding performance guarantees will be provided in response to {\bf question 3)}, which will be presented later. 

We would like to commence by elaborating the novelty of the proposed methods. In this paper, we have proposed a new approach for CSI acquisition by exploiting the power detection capability of sensing RIS. This approach is fundamentally different from the existing schemes in that: 
\begin{enumerate}
    \item The proposed CSI acquisition scheme is performed at the RIS instead of the baseband processors at the receivers. Since no RF chains are equipped at the RIS, it seems impossible to obtain the phase information of the channels. To attack this problem, we try to exploit the physical phenomenon of interference to convert the hard-to-detect phase information into easy-to-detect intensity information, which finally leads to our idea of creating the interference random field (IRF) for CSI acquisition.  
    \item The proposed IRF-based methods can realize dimension-independent CSI acquisition task in a cost-efficient manner. We have proved in this paper that it is possible to acquire enough CSI for accurate beamforming in only 3 pilot slots, without requiring too much hardware cost. It is true that dimension-independent CSI acquisition can also be realized by attaching an adequate number of RF chains to the RIS's elements [R1-R2], however, we demonstrate that the same near-optimal performance can be achieved by adding only cost-efficient power sensors, which are usually much cheaper than RF chains [R3] and much easier to be integrated onto the RIS's microwave structure [R4]. 
\end{enumerate}

\quad After proposing the concept of sensing RIS and explaining the basic principles of how it works, the remaining task is to construct an efficient algorithm to extract the desired CSI from the observed power signals. Specifically, for the RIS beamforming tasks, it suffices to estimate the phase difference $\varphi_n = \arg(f_n^*) - \arg({\bm g}_n\T {\bm w})$ between the BS-RIS and the RIS-user channels. 
Given the observed sequence $P_\ell = |\alpha + \beta\exp(\ri \psi_\ell)\exp(\ri \varphi) + v_\ell|^2$, our goal is to recover the unknown phase $\varphi$ with the prior knowledge of $\psi_\ell$ in the third pilot slot ($\alpha$ and $\beta$ can be easily estimated from the two preceding pilot slots), leading to the name ``phase estimation''. 

\quad In this paper, we have proposed three methods to solve this phase estimation problem. Due to the nonlinear nature of the squaring operation, traditional signal processing techniques including the Fourier spectrum analysis becomes suboptimal. Thus, the first proposed approach, i.e., the DFT method, serves as a suboptimal baseline for all the following proposed schemes. Furthermore, since the probability distributions of the power signals $P_\ell$ are clearly specified (noncentral chi-squared distribution), the ML method is theoretically applicable to this problem. However, the ML method involves intensive evaluations of modified Bessel functions, which is usually computationally intractable on typical RIS microcontrollers. 
Thus, to reduce the computational cost of phase estimation, we construct an expectation-maximization (EM) algorithm that assigns a von Mises prior distribution to $\varphi$, thus it is called the vM-EM algorithm. 
This algorithm regards the noiseless complex signal $\mu_\ell := \alpha+\beta\exp(\ri\psi_\ell)\exp(\ri\varphi)$ as a latent variable depending on the unknown parameter $\varphi$, and works by alternately estimating the latent variables $\mu_\ell$ and the unknown phase $\varphi$. 
Furthermore, the EM steps are carefully designed to preserve the von Mises distribution property of the updated estimator $\hat{\varphi}|\{P_\ell\}$, satisfying the conjugate prior condition [R5] for computational convenience. 
To the best of our knowledge, the methodology of leveraging von Mises distributions for phase estimation is novel, and there are no similar results in the literature. 
Furthermore, in our simulation results, the proposed vM-EM algorithm is compared with two baselines: the DFT method and the ML method, and it is demonstrated by the numerical simulation that the vM-EM method can achieve comparable performance with the ML method. 

{\bf References:}

[R1] G. C. Alexandropoulos and E. Vlachos, ``A hardware architecture for reconfigurable intelligent surfaces with minimal active elements for explicit channel estimation,'' in {\it Proc. IEEE Int. Conf. on Acoust., Speech
and Signal Process. (ICASSP)}, May 2020. 

[R2] E. Vlachos, G. C. Alexandropoulos, and J. Thompson, ``Wideband MIMO channel estimation for hybrid beamforming millimeter wave systems via random spatial sampling,'' {\it IEEE J. Sel. Topics Signal Process.}, vol. 13, no. 5, pp. 1136-1150, 2019.

[R3] Y. Zhou and M. Y.-W. Chia, ``A Low-Power Ultra-Wideband CMOS True RMS Power Detector,'' {\it IEEE Trans. Micro. Theory Techn.}, vol. 56, no. 5, pp. 1052-1058, May 2008. 

[R4] Q. Ma, G. D. Bai, H. B. Jing, C. Yang, L. Li, and T. J. Cui, ``Smart metasurface with self-adaptively reprogrammable functions,'' {\it Light: science \& applications}, vol. 8, no. 1, pp. 1-12, Oct. 2019.

[R5] P. Diaconis and D. Ylvisaker, ``Conjugate Priors for Exponential Families,'' {\it The Annals of Statistics}, vol. 7, no. 2, pp. 269-281, 1979.


}}

\textbf{Reviewer 3:}
3) All the theorems seem to be on CRLB rather than the achievability. As such, the achievable strategy and CRLB comparison will add credibility to the achievability.

{\color{blue}{\textbf{Authors: } 
Many thanks for the reivewer's positive attitude on the correctness of the CRLB. As is pointed out by the reviewer, the theoretical results in the previous version of this paper are mainly focused on the ``converse'' theorems (the CRLB) instead of the ``achievability'' theorems, which does not provide a firm performance guarantee for our proposed schemes. In order to address this concern, we have tried our best to provide theorems on the achievability of the proposed interference random field (IRF)-based CSI acquisition schemes. 

\quad These newly-added theorems and lemmas are mainly related to detection and estimation theory, which may match the broader scope of this journal. For you to check, we have provided the theoretical contents as follows with some slight modifications, e.g., the number of equations and lemmata may be different from those in the revised paper. The detailed proofs are provided in the {\bf Appendices} of the revised paper.  

\quad We would like to briefly summarize the newly-added theorems and lemmas before going into details as below. These theoretical results are mainly focused on the analysis of the proposed vM-EM phase estimation algorithm. By assuming convergence of the algorithm, we first obtain a fixed-point equation that describes how the estimator $\hat{\varphi}$ varies as a function of the sensor noise ${\bm v}$. In order to quantify how large the deviation of the estimator from the true value can be, we take the derivative of the estimator $\hat{\varphi}$ with respect to ${\bm v}$, and try to upper-bound such a derivative in order to upper-bound the estimation error. After some calculations, we find that the derivative of $\hat{\varphi}$ is jointly determined by ${\bm v}$ and the estimator $\hat{\varphi}$ itself, so we try to model this relation by an ordinary differential equation to capture the increasing rate of the estimation error. Finally, we reach the desired conclusion that the mean squared estimation error (MSE) is of order $\mathcal{O}(\bar{\gamma}^{-1})$, which is the best error decay rate expectable in most of the estimation problems where the signals are corrupted by some Gaussian noise.  
}}

\begin{framed}
    {\bf Section VI-A}

    \red{
        \begin{theorem}[Fixed-point perturbation bound] \label{thm3:asymp_perf_vM-EM}
            Assume $\alpha>\beta>0$ are fixed. Then, there exists a sufficiently large integer $L_0$, such that for any $L\geq L_0$, if the proposed vM-EM algorithm converges, the returned estimator $\hat{\varphi}$ achieves an MSE performance of $\mathbb{E}[(\hat{\varphi}-\varphi)^2] = \mathcal{O}(\bar{\gamma}^{-1})$, where $\varphi$ is the true parameter, and $\bar{\gamma}$ is the interferential SNR defined as $\bar{\gamma} = (\alpha^2+\beta^2)/\sigma_v^2$.    
        \end{theorem}
    
    
        Before proving this theorem, we first introduce the following {\bf Lemma~\ref{lemma:wirtinger_der_vM-EM}} that characterizes how the vM-EM estimator $\hat{\varphi}$ in {\bf Algorithm~2} varies with the random noise vector $\bm v$. }
    
        \red{\begin{lemma}[The speed of the fixed-point] \label{lemma3:wirtinger_der_vM-EM}
            Suppose that for the input data sequence ${\bm s} = \sqrt{{\bm P}/A} = (s_0, \cdots, s_{L-1})\T$, the vM-EM algorithm converges to the estimator $\hat{\varphi}$. Then, the estimator $\hat{\varphi} = \hat{\varphi}({\bm v})$ can be viewed as a function of the noise $\bm v$, and the Wirtinger derivative of $\hat{\varphi}$ w.r.t. $\bm v$ satisfies 
            \begin{equation}
                \|\nabla_{\bm v}\hat{\varphi}\|^2 = \frac{1}{|\langle {\bm s}, {\bm x}\rangle|^2}\sum_{\ell=0}^{L-1}  \frac{\sin^2(\theta_\ell)}{|\mu_\ell|^2}, 
            \end{equation} 
            where ${\bm x} = (x_0, \cdots, x_{L-1})\T$ is defined as 
            \begin{equation}
                x_{\ell} := \frac{(\alpha+\beta \cos\theta_\ell)(\beta+\alpha\cos\theta_\ell)}{|\mu_\ell|^3},~~\ell\in\{L\}, 
            \end{equation}
            and 
            \begin{equation}
                \begin{aligned}
                    \mu_\ell & := \alpha+\beta {\rm exp}(\ri \theta_\ell),~~\ell\in\{L\}, \\
                    \theta_\ell & := \psi_\ell + \hat{\varphi}, ~~\ell\in\{L\}. 
                \end{aligned}
            \end{equation}
        \end{lemma}
        \begin{IEEEproof}
        The proof is provided in {\bf Appendix E}. 
        \end{IEEEproof}
        }
        
        \red{The aim of {\bf Lemma~\ref{lemma:wirtinger_der_vM-EM}} is to establish the connection between the vM-EM estimator $\hat{\varphi}$ and the noise vector ${\bm v}$. In the following, we denote the estimation error as 
        \begin{equation}
            \Delta\varphi := \hat{\varphi} - \varphi. 
        \end{equation}
        Specifically, it is justified in {\bf Lemma~\ref{lemma:wirtinger_der_vM-EM}} that, the squared error $|\Delta\varphi|^2$ of the vM-EM estimator is intrinsically bounded by the noise energy $\|{\bm v}\|^2$, since the differential ${\rm d}\Delta\varphi$ of a general complex-valued function $\Delta\varphi: \mathbb{C}\to\mathbb{C}$ can be written as 
        \begin{equation}
            {\rm d}\Delta\varphi = \langle \nabla_{\bm v}\hat{\varphi}, {\rm d}{\bm v}^*\rangle + \langle \nabla_{{\bm v}^*}\hat{\varphi}, {\rm d}{\bm v}\rangle, 
        \end{equation}
        where for real-valued function $\hat{\varphi}({\bm v}): \mathbb{C}^L \to [0,2\pi]\subset \mathbb{R}$ this differential relation reduces to 
        \begin{equation}
            {\rm d}\Delta\varphi = 2\Re\langle\nabla_{\bm v}\hat{\varphi}, {\rm d}{\bm v}^*\rangle. 
            \label{eqn3:differential_of_error}
        \end{equation}
        Thus, an integration inequality will hold to upper-bound the MSE of the estimator $\hat{\varphi}$, i.e., 
        \begin{align}\label{ineq3:gradient_bound}
            |\Delta{\varphi}|^2 &= \left| \int {\rm d}\Delta\varphi \right|^2 \notag \\
            &= 4 \left| \int_{0}^{1} \Re\langle\nabla_{{\bm v}'=t {\bm v}}\hat{\varphi}, {\bm v}\rangle{\rm d}t \right|^2 \notag \\
            &\leq 4\|{\bm v}\|^2 \left(\int_{0}^{1} \|\nabla_{{\bm v}'=t{\bm v}}\hat{\varphi} \| {\rm d} t \right)^2. 
        \end{align}
    
        Before explaining this idea in detail, we first introduce some interesting results about some intermediate variables. }
        
        \red{\begin{lemma}[Asymptotic invariants]\label{lemma3:asymp_inv}
            Suppose $\alpha > \beta > 0$. If we define 
            \begin{equation}
                \begin{aligned}
                    H_L & :=\frac{1}{L}\sum_{\ell=0}^{L-1} \frac{\sin^2(\theta_\ell)}{|\mu_\ell|^2}, \\
                    G_L & := \frac{1}{L}\sum_{\ell=0}^{L-1} \frac{(\alpha+\beta \cos(\theta_\ell))(\beta+\alpha\cos(\theta_\ell))}{|\mu_\ell|^2}, \\
                \end{aligned}
            \end{equation}
            then the sequences $H_L$ and $G_L$ are intrinsically independent of the estimator $\hat{\varphi}\in[0,2\pi]$ as $L\to\infty$. Specifically, 
            \begin{equation}
                \begin{aligned}
                    H &= H_{\infty} + \mathcal{O}(L^{-1}), \\
                    G &= G_{\infty} + \mathcal{O}(L^{-1}), 
                \end{aligned}
            \end{equation}
            where 
            \begin{equation}
                \begin{aligned}
                    H_{\infty} &=  \frac{1}{2\pi}\int_{0}^{2\pi} \frac{\sin^2\theta}{\alpha^2+\beta^2+2\alpha\beta\cos(\theta)}{\rm d}\theta = \frac{1}{2\alpha^2},  \\
                    G_{\infty} &= \frac{1}{2\pi}\int_{0}^{2\pi} \frac{(\alpha+\beta\cos(\theta))(\beta+\alpha\cos(\theta))}{\alpha^2+\beta^2+2\alpha\beta\cos(\theta)} {\rm d}\theta = \frac{\beta}{2\alpha}.  \\ 
                \end{aligned}
            \end{equation}
        \end{lemma}
        }
        
        
        \red{{\it Proof Sketch.} The integral expressions for $H_\infty$ and $G_\infty$ as well as the asymptotic remainders $\mathcal{O}(L^{-1})$ can be obtained by applying the numerical trapezoidal integration formula to the definition of the sequence $H_L$ and $G_L$. The integrals on $[0,2\pi]$ can be evaluated by the following replacements:
        \begin{equation}
            \begin{aligned}
                & {\rm d}\theta  \to \frac{\d z}{\ri z}, & \int_0^{2\pi} \to \int_{|z|=1}, \\
                & \sin\theta  \to \frac{z-z^{-1}}{2\ri}, & \cos\theta \to \frac{z+z^{-1}}{2}, \\
            \end{aligned}
        \end{equation}
        and the applying the Residue Theorem to all poles inside the closed curve $|z|=1$. }
        
        \red{\begin{remark}
            These limiting expressions will play an important rule in obtaining the upper bound of the estimation error $|\Delta\varphi|$, since this invariance can asymptotically eliminate the dependency of the Wirtinger derivative ({\bf Lemma~\ref{lemma:wirtinger_der_vM-EM}}) on the unknown estimator $\hat{\varphi}$. 
        \end{remark}}
        
        \red{\begin{remark}
            In fact, we can also prove that 
            \begin{equation}
                \frac{\|{\bm x}\|^2}{L} = \frac{2\alpha^2-\beta^2/2}{4\alpha^2(\alpha^2-\beta^2)} + \mathcal{O}(L^{-1}),~~\alpha>\beta>0
            \end{equation}
            by the same numerical integration approximation technique and the Residue Theorem. 
        \end{remark} }
        
        
        \red{\begin{lemma}[ODE bound] \label{lemma3:ODE-bound}
            Suppose for the input data sequence ${\bm s} = \sqrt{{\bm P}/A} = (s_0, \cdots, s_{L-1})\T$, the vM-EM algorithm converges, and the estimation error is denoted by $\Delta\varphi = \hat{\varphi} - \varphi$. Then, for any sufficiently large $L\geq L_0$, there exists some positive $\delta = \delta(L)>0$ and $C=C(L)>0$, such that for any noise vector ${\bm v}$ satisfying $\|{\bm v}\|/\sqrt{L} \leq \delta$, the estimation error is upper-bounded by
            \begin{equation}
                |\Delta\varphi|\leq C \frac{\|{\bm v}\|}{\sqrt{L}}. 
            \end{equation}
        \end{lemma}
        \begin{IEEEproof}
            The proof is provided in {\bf Appendix~F}. 
        \end{IEEEproof}
        From the above {\bf Lemma~\ref{lemma:ODE-bound}}, we can directly prove {\bf Theorem~\ref{thm:asymp_perf_vM-EM}}. Choose $L\geq L_0$, and then let us compute the MMSE of the vM-EM estimator, i.e., 
        \ifx\onecol\undefined
        \begin{equation}
            \begin{aligned}
            \mathbb{E}[(\hat{\varphi}-\varphi)^2] &= \mathbb{E}[|\Delta\varphi|^2] \\
            &= \mathbb{E}\left[|\Delta\varphi|^2 \Bigg|\frac{\|{\bm v}\|}{\sqrt{L}} \leq \delta \right]\mathbb{P}\left[\frac{\|{\bm v}\|}{\sqrt{L}} \leq \delta \right] \\
            & + \mathbb{E}\left[|\Delta\varphi|^2 \Bigg|\frac{\|{\bm v}\|}{\sqrt{L}} > \delta \right]\mathbb{P}\left[\frac{\|{\bm v}\|}{\sqrt{L}}>\delta \right] \\
            & \leq C^2 \mathbb{E}\left[\frac{\|{\bm v}\|^2}{L}\right] + \pi^2 \mathbb{P}\left[\frac{\|{\bm v}\|}{\sqrt{L}}>\delta\right] \\
            & \overset{(a)}{\leq} C^2\sigma_v^2 + \pi^2 \frac{\mathbb{E}\left[\left(\frac{\|{\bm v}\|}{\sqrt{L}}\right)^r\right]}{\delta^r},
            \end{aligned}
        \end{equation}
        \else 
        \begin{equation}
            \begin{aligned}
            \mathbb{E}[(\hat{\varphi}-\varphi)^2] &= \mathbb{E}[|\Delta\varphi|^2] \\
            &= \mathbb{E}\left[|\Delta\varphi|^2 \Bigg|\frac{\|{\bm v}\|}{\sqrt{L}} \leq \delta \right]\mathbb{P}\left[\frac{\|{\bm v}\|}{\sqrt{L}} \leq \delta \right] + \mathbb{E}\left[|\Delta\varphi|^2 \Bigg|\frac{\|{\bm v}\|}{\sqrt{L}} > \delta \right]\mathbb{P}\left[\frac{\|{\bm v}\|}{\sqrt{L}}>\delta \right] \\
            & \leq C^2 \mathbb{E}\left[\frac{\|{\bm v}\|^2}{L}\right] + \pi^2 \mathbb{P}\left[\frac{\|{\bm v}\|}{\sqrt{L}}>\delta\right] \\
            & \overset{(a)}{\leq} C^2\sigma_v^2 + \pi^2 \frac{\mathbb{E}\left[\left(\frac{\|{\bm v}\|}{\sqrt{L}}\right)^r\right]}{\delta^r},
            \end{aligned}
        \end{equation}
        \fi
        where (a) comes from applying the Markov inequality, and $r>0$ can be arbitrarily chosen. Particularly, by setting $r=2$, we obtain 
        \begin{equation}
            \mathbb{E}\left[(\hat{\varphi} - \varphi)\right] \leq \sigma_v^2(C^2+\pi^2/\delta^2) = \mathcal{O}(\bar{\gamma}^{-1}),  
        \end{equation}
        which completes the proof of {\bf Theorem~\ref{thm:asymp_perf_vM-EM}}.  }
        
        \red{\begin{remark}
            The conclusion of {\bf Theorem~\ref{thm:asymp_perf_vM-EM}} guarantees that as $\bar{\gamma}\to\infty$, the MSE of the vM-EM estimator decays at a rate of at least $(\bar{\gamma})^{-1}$. This conclusion is verified in the following numerical simulation, where it is shown that the MSE curve of the proposed vM-EM algorithm has an asymptotic slope of $-1$ in the logarithmic coordinate. 
        \end{remark} }
    \end{framed}



{\color{blue}{\textbf{Authors: } 
Many thanks again for your valuable time and efforts to review this paper. 

Sincerely, \\
{\it The Authors }
}}


\clearpage 


\end{document}
